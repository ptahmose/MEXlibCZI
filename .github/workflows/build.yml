name: Build
on: 
  push:
  workflow_dispatch:

jobs:
  build:
    runs-on: windows-latest
    steps:
      - name: Check out repository
        uses: actions/checkout@v4
      - name: Set up MATLAB
        uses: matlab-actions/setup-matlab@v2
      - name: Run MATLAB script
        uses: matlab-actions/run-command@v2
        with:
          command: |
            headerPath = fullfile(matlabroot, 'extern', 'include');fprintf('Header files are located at: %s\n', headerPath);
      - name: run build
        shell: cmd
        run: |
          set
          dir c:\ /s
          dir d:\ /s
          mkdir build
          cd build
          cmake .. -A x64 -DCMAKE_BUILD_TYPE=Release -DMEXLIBCZI_HEADERS=$(Build.SourcesDirectory)/matlabheaders/include -DMEXLIBCZI_LIBS=$(Build.SourcesDirectory)/matlabheaders/lib
          cmake --build . --config Release
